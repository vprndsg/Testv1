<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Noir Detective 3D</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      color: #fff;
      height: 100%;
      width: 100%;
      font-family: Arial, sans-serif;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <canvas id="scene"></canvas>
  <script>
    const canvas = document.getElementById('scene');
    const ctx = canvas.getContext('2d');

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', () => {
      resize();
      initRain();
    });
    resize();

    const rain = [];
    const dropCount = 200;
    function initRain() {
      rain.length = 0;
      for (let i = 0; i < dropCount; i++) {
        rain.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          speed: 4 + Math.random() * 4,
          len: 10 + Math.random() * 10
        });
      }
    }
    initRain();

    function drawRain() {
      ctx.strokeStyle = 'rgba(180,180,255,0.5)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      for (const drop of rain) {
        ctx.moveTo(drop.x, drop.y);
        ctx.lineTo(drop.x, drop.y + drop.len);
        drop.y += drop.speed;
        if (drop.y > canvas.height) {
          drop.y = -drop.len;
          drop.x = Math.random() * canvas.width;
        }
      }
      ctx.stroke();
    }

    function drawDetective() {
      const centerX = canvas.width / 2;
      const groundY = canvas.height * 0.9;
      const bodyHeight = canvas.height * 0.6;
      const headR = 20;
      const headY = groundY - bodyHeight + headR;
      const hatWidth = 80;
      const hatDepth = 25;

      ctx.lineWidth = 2;
      ctx.strokeStyle = '#555';

      // Coat
      ctx.fillStyle = '#222';
      ctx.beginPath();
      ctx.moveTo(centerX - 40, groundY);
      ctx.lineTo(centerX + 40, groundY);
      ctx.lineTo(centerX + 20, groundY - bodyHeight + 40);
      ctx.lineTo(centerX - 20, groundY - bodyHeight + 40);
      ctx.closePath();
      ctx.fill();
      ctx.stroke();

      // Head with radial gradient for 3D effect
      const faceGrad = ctx.createRadialGradient(centerX - 10, headY - 10, 5, centerX, headY, headR);
      faceGrad.addColorStop(0, '#444');
      faceGrad.addColorStop(1, '#111');
      ctx.fillStyle = faceGrad;
      ctx.beginPath();
      ctx.arc(centerX, headY, headR, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();

      // Hat brim - ellipse for perspective
      ctx.fillStyle = '#222';
      ctx.beginPath();
      ctx.ellipse(centerX, headY - headR - 5, hatWidth / 2, hatDepth / 2, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();

      // Hat top with gradient to add dimension
      const topH = 30;
      const hatGrad = ctx.createLinearGradient(centerX, headY - headR - topH, centerX, headY - headR);
      hatGrad.addColorStop(0, '#333');
      hatGrad.addColorStop(1, '#111');
      ctx.fillStyle = hatGrad;
      ctx.beginPath();
      ctx.rect(centerX - hatWidth / 4, headY - headR - topH, hatWidth / 2, topH);
      ctx.fill();
      ctx.stroke();
    }

    function loop() {
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      drawDetective();
      drawRain();
      requestAnimationFrame(loop);
    }
    loop();
  </script>
</body>
</html>
